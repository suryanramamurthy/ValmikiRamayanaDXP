{"version":3,"sources":["../../../src/lib/entry.ts"],"sourcesContent":["import { AxiosInstance, getData } from '@contentstack/core';\nimport { ErrorMessages } from './error-messages';\n\ninterface EntryResponse<T> {\n  entry: T;\n}\nexport class Entry {\n  protected _client: AxiosInstance;\n  private _contentTypeUid: string;\n  private _entryUid: string;\n  private _urlPath: string;\n  protected _variants: string;\n  _queryParams: { [key: string]: string | number | string[] } = {};\n  constructor(client: AxiosInstance, contentTypeUid: string, entryUid: string) {\n    this._client = client;\n    this._contentTypeUid = contentTypeUid;\n    this._entryUid = entryUid;\n    this._urlPath = `/content_types/${this._contentTypeUid}/entries/${this._entryUid}`;\n    this._variants = '';\n  }\n\n  /**\n   * @method includeFallback\n   * @memberof Entry\n   * @description When an entry is not published in a specific language, content can be fetched from its fallback language\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry(entry_uid).includeFallback().fetch();\n   */\n  includeFallback(): this {\n    this._queryParams.include_fallback = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method variants\n   * @memberof Entry\n   * @description The variant header will be added to axios client\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType('abc').entry('entry_uid').variants('xyz').fetch();\n   */\n  variants(variants: string | string[]): this {\n    if (Array.isArray(variants) && variants.length > 0) {\n      this._variants = variants.join(',');\n    } else if (typeof variants == 'string' && variants.length > 0) {\n      this._variants = variants;\n    }\n\n    return this;\n  }\n\n  /**\n   * @method includeMetadata\n   * @memberof Entry\n   * @description Include the metadata for getting metadata content for the entry.\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry(entry_uid).includeMetadata().fetch();\n   */\n  includeMetadata(): this {\n    this._queryParams.include_metadata = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeEmbeddedItems\n   * @memberof Entry\n   * @description Include Embedded Objects (Entry and Assets) along with entry/entries details.\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry(entry_uid).includeEmbeddedItems().fetch();\n   */\n  includeEmbeddedItems(): this {\n    this._queryParams['include_embedded_items[]'] = 'BASE';\n\n    return this;\n  }\n\n  /**\n   * @method includeReference\n   * @memberof Entry\n   * @description To include the content of the referred entry in your response,\n   * you need to use the include[] parameter and specify the UID of the reference field as value.\n   * This function sets the include parameter to a reference field UID in the API request.\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry(entry_uid).includeReference(\"brand\").fetch()\n   *\n   * @param {string} referenceFieldUid - UID of the reference field to include.\n   * @returns {Entry} - Returns the Entry instance for chaining.\n   */\n  includeReference(...referenceFieldUid: (string | string[])[]): this {\n    if (referenceFieldUid.length) {\n      referenceFieldUid.forEach(value => {\n        if (!Array.isArray(this._queryParams['include[]'])) {\n          this._queryParams['include[]'] = [];\n        }\n        (this._queryParams['include[]'] as string[]).push(...(Array.isArray(value) ? value : [value]));\n      });\n    } else {\n      console.error(ErrorMessages.INVALID_ARGUMENT_STRING_OR_ARRAY);\n    }\n    return this;\n  }\n\n  /**\n   * @method includeContentType\n   * @memberof Entry\n   * @description Include the details of the content type along with the entries details\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry(entry_uid).includeContentType().fetch();\n   */\n  includeContentType(): this {\n    this._queryParams.include_content_type = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeBranch\n   * @memberof Entry\n   * @description Includes the branch in result\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry(entry_uid).includeBranch().fetch();\n   */\n  includeBranch(): this {\n    this._queryParams.include_branch = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method locale\n   * @memberof Entry\n   * @description The entry published in the locale will be fetched\n   * @returns {Entry}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType('contentTypeUid').entry('entryUid').locale('en-us').fetch();\n   */\n  locale(locale: string): this {\n    this._queryParams.locale = locale;\n\n    return this;\n  }\n\n  /**\n   * @method fetch\n   * @memberof Entry\n   * @description Fetches the entry data on the basis of the entry uid\n   * @returns {Promise<T>} Promise that resolves to the entry data\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry(entry_uid).fetch();\n   */\n  async fetch<T>(): Promise<T> {\n    const getRequestOptions: any = { \n      params: this._queryParams,\n      // Add contentTypeUid and entryUid to config for improved caching\n      contentTypeUid: this._contentTypeUid,\n      entryUid: this._entryUid\n    };\n    if (this._variants) {\n      getRequestOptions.headers = {\n        ...getRequestOptions.headers,\n        'x-cs-variant-uid': this._variants\n      };\n    }\n\n    const response = await getData(this._client, this._urlPath, getRequestOptions);\n\n    if (response.entry) return response.entry as T;\n\n    return response;\n  }\n\n  /**\n   * @method addParams\n   * @memberof Entry\n   * @description Adds a query parameter to the query.\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry(\"entryUid\").addParams({\"key\": \"value\"}).fetch()\n   *\n   * @returns {Entry}\n   */\n  addParams(paramObj: { [key: string]: string | number | string[] }): this {\n    this._queryParams = { ...this._queryParams, ...paramObj };\n\n    return this;\n  }\n\n  /**\n   * @method except\n   * @memberof Entry\n   * @description Excludes specific field/fields of an entry\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry(\"entryUid\").except(\"fieldUID\").fetch()\n   *\n   * @param {string} fieldUid - field uid to exclude\n   * @returns {Entry} - returns Entry object for chaining method calls\n   */\n  except(fieldUid: string|string[]): this {\n    if (Array.isArray(fieldUid)) {\n      let i = 0;\n      for (const uid of fieldUid) {\n        this._queryParams[`except[BASE][${i}]`] = uid;\n        i++;\n      }\n    } else {\n      this._queryParams[\"except[BASE][]\"] = fieldUid;\n    }\n\n    return this;\n  }\n\n  /**\n   * @method only\n   * @memberof Entry\n   * @description Selects specific field/fields of an entry\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry(\"entryUid\").only(\"fieldUID\").fetch()\n   *\n   * @param {string} fieldUid - field uid to select\n   * @returns {Entry} - returns Entry object for chaining method calls\n   */\n  only(fieldUid: string|string[]): this {\n    if (Array.isArray(fieldUid)) {\n      let i = 0;\n      for (const uid of fieldUid) {\n        this._queryParams[`only[BASE][${i}]`] = uid;\n        i++;\n      }\n    } else {\n      this._queryParams[\"only[BASE][]\"] = fieldUid;\n    }\n    return this;\n  }\n}\n"],"mappings":"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","names":[]}