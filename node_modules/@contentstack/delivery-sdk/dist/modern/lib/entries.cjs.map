{"version":3,"sources":["../../../src/lib/entries.ts"],"sourcesContent":["import { AxiosInstance, getData } from '@contentstack/core';\nimport { Query } from './query';\nimport { BaseQuery } from './base-query';\nimport { FindResponse } from './types';\nimport { encodeQueryParams } from './utils';\nimport { ErrorMessages } from './error-messages';\n\nexport class Entries extends BaseQuery {\n  private _contentTypeUid: string;\n\n  constructor(client: AxiosInstance, contentTypeUid: string) {\n    super();\n    this._client = client;\n    this._contentTypeUid = contentTypeUid;\n    this._urlPath = `/content_types/${this._contentTypeUid}/entries`;\n    this._variants = '';\n  }\n\n  /**\n   * @method except\n   * @memberof Entries\n   * @description Excludes specific field/fields of an entry\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry().except(\"fieldUID\").find()\n   *\n   * @param {string} fieldUid - field uid to exclude\n   * @returns {Entries} - returns Entries object for chaining method calls\n   */\n  except(fieldUid: string|string[]): this {\n    if (Array.isArray(fieldUid)) {\n      let i = 0;\n      for (const uid of fieldUid) {\n        this._queryParams[`except[BASE][${i}]`] = uid;\n        i++;\n      }\n    } else {\n      this._queryParams[\"except[BASE][]\"] = fieldUid;\n    }\n\n    return this;\n  }\n\n  /**\n   * @method includeBranch\n   * @memberof Entries\n   * @description Includes the branch in result\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry().includeBranch().find();\n   */\n  includeBranch(): Entries {\n    this._queryParams.include_branch = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeContentType\n   * @memberof Entries\n   * @description Include the details of the content type along with the entries details\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry().includeContentType().find();\n   */\n  includeContentType(): Entries {\n    this._queryParams.include_content_type = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeEmbeddedItems\n   * @memberof Entries\n   * @description Include Embedded Objects (Entries and Assets) along with entry/entries details.\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry().includeEmbeddedItems().find();\n   */\n  includeEmbeddedItems(): Entries {\n    this._queryParams['include_embedded_items[]'] = 'BASE';\n\n    return this;\n  }\n\n  /**\n   * @method includeFallback\n   * @memberof Entries\n   * @description When an entry is not published in a specific language, content can be fetched from its fallback language\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry().includeFallback().find();\n   */\n  includeFallback(): Entries {\n    this._queryParams.include_fallback = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeMetadata\n   * @memberof Entries\n   * @description Include the metadata for getting metadata content for the entry.\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(contentType_uid).entry().includeMetadata().find();\n   */\n  includeMetadata(): Entries {\n    this._queryParams.include_metadata = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeReference\n   * @memberof Entries\n   * @description To include the content of the referred entries in your response,\n   * you need to use the include[] parameter and specify the UID of the reference field as value.\n   * This function sets the include parameter to a reference field UID in the API request.\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const entries = stack.contentType(\"contentTypeUid\").entry().includeReference(\"brand\")\n   * const result = await entries.find()\n   *\n   * @param {string} referenceFieldUid - UID of the reference field to include.\n   * @returns {Entries} - Returns the Entries instance for chaining.\n   */\n  includeReference(...referenceFieldUid: (string | string[])[]): Entries {\n    if (referenceFieldUid.length) {\n      referenceFieldUid.forEach(value => {\n        if (!Array.isArray(this._queryParams['include[]'])) {\n          this._queryParams['include[]'] = [];\n        }\n        (this._queryParams['include[]'] as string[]).push(...(Array.isArray(value) ? value : [value]));\n      });\n    } else {\n      console.error(ErrorMessages.INVALID_ARGUMENT_STRING_OR_ARRAY);\n    }\n    return this;\n  }\n\n  /**\n   * @method includeReferenceContentTypeUID\n   * @memberof Entries\n   * @description This method also includes the content type UIDs of the referenced entries returned in the response.\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const entries = stack.contentType(\"contentTypeUid\").entry().includeReferenceContentTypeUID()\n   * const result = await entries.find()\n   *\n   * @returns {Entries} - Returns the Entries instance for chaining.\n   */\n  includeReferenceContentTypeUID(): Entries {\n    this._queryParams.include_reference_content_type_uid = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method includeSchema\n   * @memberof Entries\n   * @description Includes the schema of the content type along with the entries details.\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const entries = stack.contentType(\"contentTypeUid\").entry().includeSchema()\n   * const result = await entries.find()\n   *\n   * @returns {Entries} - Returns the Entries instance for chaining.\n   */\n  includeSchema(): Entries {\n    this._queryParams.include_schema = 'true';\n\n    return this;\n  }\n\n  /**\n   * @method locale\n   * @memberof Entries\n   * @description The entries published in the locale will be fetched\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry().locale('en-us').find();\n   */\n  locale(locale: string): Entries {\n    this._queryParams.locale = locale;\n\n    return this;\n  }\n\n  /**\n   * @method only\n   * @memberof Entries\n   * @description Selects specific field/fields of an entry\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType(\"contentTypeUid\").entry().only(\"fieldUID\").find()\n   *\n   * @param {string} fieldUid - field uid to select\n   * @returns {Entries} - returns Entries object for chaining method calls\n   */\n  only(fieldUid: string|string[]): this {\n    if (Array.isArray(fieldUid)) {\n      let i = 0;\n      for (const uid of fieldUid) {\n        this._queryParams[`only[BASE][${i}]`] = uid;\n        i++;\n      }\n    } else {\n      this._queryParams[\"only[BASE][]\"] = fieldUid;\n    }\n    return this;\n  }\n\n  /**\n   * @method query\n   * @memberof Entries\n   * @description Creates a query object for filtering entries\n   * @param {object} queryObj - Optional query object to initialize the query\n   * @returns {Query} Query instance for chaining query methods\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const query = stack.contentType(\"contentTypeUid\").entry().query();\n   */\n  query(queryObj?: { [key: string]: any }) {\n    if (queryObj) return new Query(this._client, this._parameters, this._queryParams, this._variants, this._contentTypeUid, queryObj);\n\n    return new Query(this._client, this._parameters, this._queryParams, this._variants, this._contentTypeUid);\n  }\n\n  /**\n   * @method variants\n   * @memberof Entries\n   * @description The variant header will be added to axios client\n   * @returns {Entries}\n   * @example\n   * import contentstack from '@contentstack/delivery-sdk'\n   *\n   * const stack = contentstack.stack({ apiKey: \"apiKey\", deliveryToken: \"deliveryToken\", environment: \"environment\" });\n   * const result = await stack.contentType('abc').entry().variants('xyz').find();\n   */\n  variants(variants: string | string[]): Entries {\n    if (Array.isArray(variants) && variants.length > 0) {\n      this._variants = variants.join(',');\n    } else if (typeof variants == 'string' && variants.length > 0) {\n      this._variants = variants;\n    }\n    return this;\n  }\n\n  /**\n   * Override find method to include content type UID directly for better caching\n   */\n  override async find<T>(encode: boolean = false): Promise<FindResponse<T>> {\n    let requestParams: { [key: string]: any } = this._queryParams;\n\n    if (Object.keys(this._parameters).length > 0) {\n      let queryParams = { ...this._parameters };\n      \n      if (encode) {\n        queryParams = encodeQueryParams(queryParams);\n      }\n      \n      requestParams = { ...this._queryParams, query: queryParams };\n    }\n\n    const getRequestOptions: any = { \n      params: requestParams,\n      // Add contentTypeUid directly for improved caching\n      contentTypeUid: this._contentTypeUid\n    };\n\n    if (this._variants) {\n      getRequestOptions.headers = {\n        ...getRequestOptions.headers,\n        'x-cs-variant-uid': this._variants\n      };\n    }\n    const response = await getData(this._client, this._urlPath, getRequestOptions);\n\n    return response as FindResponse<T>;\n  }\n}\n"],"mappings":"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","names":[]}